"use strict";
var myCanvas = document.querySelector('#qipan');
var btnhui = document.querySelector('.btnhui');
var btnche = document.querySelector('.btnche');
var btncz = document.querySelector('.btncz');
var cheqi = false;
var huiqi = false;
var size = 25;
var sizeNumber = 21;
var r = 10;
var weizi = [0, 0];
var qiziColor = 1;
var qiziColorData = new Array(sizeNumber);
for (var i = 0; i < sizeNumber; i++) {
    qiziColorData[i] = new Array(sizeNumber);
}
for (var n = 0; n < sizeNumber; n++) {
    for (var m = 0; m < sizeNumber; m++) {
        qiziColorData[n][m] = 3;
    }
}
var ctx = myCanvas.getContext('2d');
function qipan() {
    for (var i = 0; i < sizeNumber; i++) {
        ctx.beginPath();
        ctx.moveTo(0, size * i);
        ctx.lineTo(500, size * i);
        ctx.moveTo(size * i, 0);
        ctx.lineTo(size * i, 500);
        ctx.stroke();
        ctx.closePath();
    }
}
qipan();
function qizi(row, col, color) {
    ctx.beginPath();
    ctx.arc(row, col, r, 0, 2 * Math.PI);
    ctx.fillStyle = color;
    ctx.fill();
    ctx.closePath();
}
myCanvas.onclick = function (e) {
    var x = e.clientX - myCanvas.offsetLeft;
    var y = e.clientY - myCanvas.offsetTop;
    var i = Math.round(x / size);
    var j = Math.round(y / size);
    weizi = [i, j];
    if (qiziColorData[i][j] == 3) {
        if (qiziColor) {
            qizi(i * size, j * size, 'red');
            qiziColor = 0;
            qiziColorData[i][j] = 1;
        }
        else {
            qizi(i * size, j * size, 'black');
            qiziColor = 1;
            qiziColorData[i][j] = 0;
        }
    }
    judge(i, j);
    cheqi = false;
    huiqi = true;
};
btnhui.onclick = function () {
    if (huiqi == true) {
        ctx.clearRect(weizi[0] * size - r, weizi[1] * size - r, size, size);
        ctx.beginPath();
        ctx.moveTo((weizi[0] - 1) * size, weizi[1] * size);
        ctx.lineTo((weizi[0] + 1) * size, weizi[1] * size);
        ctx.moveTo(weizi[0] * size, (weizi[1] - 1) * size);
        ctx.lineTo(weizi[0] * size, (weizi[1] + 1) * size);
        ctx.stroke();
        ctx.closePath;
        qiziColor = qiziColor == 1 ? 0 : 1;
        cheqi = true;
        qiziColorData[weizi[0]][weizi[1]] = 3;
    }
};
btnche.onclick = function () {
    if (cheqi == true) {
        ctx.beginPath();
        ctx.arc(weizi[0] * size, weizi[1] * size, r, 0, 2 * Math.PI);
        if (qiziColor == 1) {
            ctx.fillStyle = 'red';
        }
        else {
            ctx.fillStyle = 'black';
        }
        ctx.fill();
        ctx.closePath();
        qiziColorData[weizi[0]][weizi[1]] = qiziColor;
        qiziColor = qiziColor == 1 ? 0 : 1;
        cheqi = false;
    }
};
btncz.onclick = function () {
    ctx.clearRect(0, 0, 500, 500);
    qipan();
};
function judge(row, col) {
    var directionData = [
        [-1, 0], [1, 0],
        [0, -1], [0, 1],
        [-1, 1], [1, -1],
        [-1, -1], [1, 1]
    ];
    var _loop_1 = function (i) {
        var _a;
        var color = qiziColorData[row][col];
        var nextX = 0, nextY = 0, offsetX = 0, offsetY = 0;
        var count = 1;
        if (i % 2 == 0) {
            count = 1;
        }
        _a = directionData.pop(), offsetX = _a[0], offsetY = _a[1];
        nextX = row;
        nextY = col;
        while (nextX + offsetX >= 0 && nextX + offsetX < 21 &&
            nextY + offsetY >= 0 && nextY + offsetY < 21 &&
            qiziColorData[nextX += offsetX][nextY += offsetY] == color) {
            count++;
        }
        if (count >= 5) {
            setTimeout(function () { return alert("\u606D\u559C" + '黑红'[color] + "\u8272\u68CB\u5B50\u83B7\u80DC!"); });
            return "break";
        }
    };
    for (var i = 0; i < 8; i++) {
        var state_1 = _loop_1(i);
        if (state_1 === "break")
            break;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid3V6aXFpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsid3V6aXFpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxJQUFJLFFBQVEsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBc0IsQ0FBQztBQUVyRSxJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBbUIsQ0FBQztBQUVqRSxJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBbUIsQ0FBQztBQUVqRSxJQUFJLEtBQUssR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBbUIsQ0FBQztBQUUvRCxJQUFJLEtBQUssR0FBWSxLQUFLLENBQUU7QUFFNUIsSUFBSSxLQUFLLEdBQVksS0FBSyxDQUFFO0FBRTVCLElBQU0sSUFBSSxHQUFXLEVBQUUsQ0FBQztBQUV4QixJQUFNLFVBQVUsR0FBVyxFQUFFLENBQUM7QUFFOUIsSUFBTSxDQUFDLEdBQVcsRUFBRSxDQUFDO0FBRXJCLElBQUksS0FBSyxHQUFhLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBSTdCLElBQUksU0FBUyxHQUFTLENBQUMsQ0FBQztBQUV4QixJQUFJLGFBQWEsR0FBYSxJQUFJLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNwRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxFQUFFLENBQUMsRUFBRSxFQUFFO0lBQ2pDLGFBQWEsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztDQUM1QztBQUNELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQUU7SUFDakMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUNqQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQzNCO0NBQ0o7QUFDRCxJQUFJLEdBQUcsR0FBRyxRQUFRLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBNkIsQ0FBQztBQUloRSxTQUFTLEtBQUs7SUFDVixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ2pDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNoQixHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDeEIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzFCLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUN4QixHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksR0FBRyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDMUIsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2IsR0FBRyxDQUFDLFNBQVMsRUFBRSxDQUFDO0tBQ25CO0FBQ0wsQ0FBQztBQUNELEtBQUssRUFBRSxDQUFDO0FBT1IsU0FBUyxJQUFJLENBQUMsR0FBVyxFQUFFLEdBQVcsRUFBRSxLQUFhO0lBQ2pELEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNoQixHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFBO0lBQ3BDLEdBQUcsQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO0lBQ3RCLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNYLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztBQUNwQixDQUFDO0FBS0QsUUFBUSxDQUFDLE9BQU8sR0FBRyxVQUFVLENBQWE7SUFDdEMsSUFBSSxDQUFDLEdBQVcsQ0FBQyxDQUFDLE9BQU8sR0FBRyxRQUFRLENBQUMsVUFBVSxDQUFDO0lBQ2hELElBQUksQ0FBQyxHQUFXLENBQUMsQ0FBQyxPQUFPLEdBQUcsUUFBUSxDQUFDLFNBQVMsQ0FBQztJQUMvQyxJQUFJLENBQUMsR0FBVyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztJQUNyQyxJQUFJLENBQUMsR0FBVyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztJQUNyQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDZixJQUFJLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDMUIsSUFBSSxTQUFTLEVBQUU7WUFDWCxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ2hDLFNBQVMsR0FBRyxDQUFDLENBQUM7WUFDZCxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzNCO2FBQU07WUFDSCxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBQ2xDLFNBQVMsR0FBRyxDQUFDLENBQUM7WUFDZCxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzNCO0tBQ0o7SUFDRCxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO0lBQ1gsS0FBSyxHQUFHLEtBQUssQ0FBQztJQUNkLEtBQUssR0FBRyxJQUFJLENBQUM7QUFDakIsQ0FBQyxDQUFBO0FBSUQsTUFBTSxDQUFDLE9BQU8sR0FBRztJQUNiLElBQUksS0FBSyxJQUFJLElBQUksRUFBRTtRQUNmLEdBQUcsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3BFLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUVoQixHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUE7UUFDbEQsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFBO1FBRWxELEdBQUcsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQTtRQUNsRCxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUE7UUFFbEQsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2IsR0FBRyxDQUFDLFNBQVMsQ0FBQztRQUNkLFNBQVMsR0FBRyxTQUFTLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1FBQ2IsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztLQUN6QztBQUVMLENBQUMsQ0FBQTtBQUlELE1BQU0sQ0FBQyxPQUFPLEdBQUc7SUFDYixJQUFJLEtBQUssSUFBSSxJQUFJLEVBQUU7UUFDZixHQUFHLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDaEIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQzVELElBQUksU0FBUyxJQUFJLENBQUMsRUFBRTtZQUNoQixHQUFHLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztTQUN6QjthQUFNO1lBQ0gsR0FBRyxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUM7U0FDM0I7UUFDRCxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDWCxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDaEIsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQztRQUM5QyxTQUFTLEdBQUcsU0FBUyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFDbEMsS0FBSyxHQUFHLEtBQUssQ0FBQztLQUNqQjtBQUNMLENBQUMsQ0FBQTtBQUNELEtBQUssQ0FBQyxPQUFPLEdBQUc7SUFDWixHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQzlCLEtBQUssRUFBRSxDQUFDO0FBQ1osQ0FBQyxDQUFBO0FBT0QsU0FBUyxLQUFLLENBQUMsR0FBVyxFQUFFLEdBQVc7SUFDbkMsSUFBTSxhQUFhLEdBQWU7UUFDOUIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDZixDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNmLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDaEIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUNuQixDQUFBOzRCQUNRLENBQUM7O1FBQ04sSUFBSSxLQUFLLEdBQUcsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLElBQUksS0FBSyxHQUFHLENBQUMsRUFBRSxLQUFLLEdBQUcsQ0FBQyxFQUFFLE9BQU8sR0FBRyxDQUFDLEVBQUUsT0FBTyxHQUFHLENBQUMsQ0FBQztRQUNuRCxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUM7UUFDZCxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ1osS0FBSyxHQUFHLENBQUMsQ0FBQztTQUNiO1FBQ0QsS0FBcUIsYUFBYSxDQUFDLEdBQUcsRUFBRSxFQUF2QyxPQUFPLFFBQUEsRUFBRSxPQUFPLFFBQUEsQ0FBd0I7UUFDekMsS0FBSyxHQUFHLEdBQUcsQ0FBQztRQUNaLEtBQUssR0FBRyxHQUFHLENBQUM7UUFDWixPQUFPLEtBQUssR0FBRyxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssR0FBRyxPQUFPLEdBQUcsRUFBRTtZQUMvQyxLQUFLLEdBQUcsT0FBTyxJQUFJLENBQUMsSUFBSSxLQUFLLEdBQUcsT0FBTyxHQUFHLEVBQUU7WUFDNUMsYUFBYSxDQUFDLEtBQUssSUFBSSxPQUFPLENBQUMsQ0FBQyxLQUFLLElBQUksT0FBTyxDQUFDLElBQUksS0FBSyxFQUFFO1lBQzVELEtBQUssRUFBRSxDQUFDO1NBQ1g7UUFDRCxJQUFJLEtBQUssSUFBSSxDQUFDLEVBQUU7WUFDWixVQUFVLENBQUMsY0FBTSxPQUFBLEtBQUssQ0FBQyxpQkFBSyxJQUFJLENBQUMsS0FBSyxDQUFDLG9DQUFRLENBQUMsRUFBL0IsQ0FBK0IsQ0FBQyxDQUFDOztTQUVyRDs7SUFsQkwsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUU7OEJBQWpCLENBQUM7OztLQW1CVDtBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKirnlLvluIMgKi9cclxubGV0IG15Q2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3FpcGFuJykgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbi8qKuaClOaji+aMiemSriAqL1xyXG5sZXQgYnRuaHVpID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ0bmh1aScpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG4vKirmkqTplIDmjInpkq4gKi9cclxubGV0IGJ0bmNoZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG5jaGUnKSBhcyBIVE1MRGl2RWxlbWVudDtcclxuLyoq6YeN572u5oyJ6ZKuICovXHJcbmxldCBidG5jeiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG5jeicpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG4vKirmkqTmo4vnirbmgIHvvJsgKi9cclxubGV0IGNoZXFpOiBib29sZWFuID0gZmFsc2UgO1xyXG4vKirmgpTmo4vnirbmgIHvvJsgKi9cclxubGV0IGh1aXFpOiBib29sZWFuID0gZmFsc2UgO1xyXG4vKirmoLzlrZDnmoTlsLrlr7jlpKflsI8gKi9cclxuY29uc3Qgc2l6ZTogbnVtYmVyID0gMjU7XHJcbi8qKuihjOWIl+aVsCAqL1xyXG5jb25zdCBzaXplTnVtYmVyOiBudW1iZXIgPSAyMTtcclxuLyoq5ZyG55qE5Y2K5b6EICovXHJcbmNvbnN0IHI6IG51bWJlciA9IDEwO1xyXG4vKirmnIDlkI7kuIDmraXnmoTkvY3nva7kv6Hmga8gKi9cclxubGV0IHdlaXppOiBudW1iZXJbXSA9IFswLCAwXTtcclxuLyoq5qOL5a2Q6aKc6Imy57G75Z6LICovXHJcbnR5cGUgUGF3biA9IDB8MXwzOyBcclxuLyoq5LiL5qOL6aKc6Imy77yMMeaYr+e6ouiJsu+8jDDmmK/pu5HoibIqL1xyXG5sZXQgcWl6aUNvbG9yOiBQYXduID0gMTtcclxuLyoq5qOL55uY5LiK5L2N572u55qE6aKc6Imy5L+h5oGvICovXHJcbmxldCBxaXppQ29sb3JEYXRhOiBQYXduW11bXSA9IG5ldyBBcnJheShzaXplTnVtYmVyKTtcclxuZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplTnVtYmVyOyBpKyspIHtcclxuICAgIHFpemlDb2xvckRhdGFbaV0gPSBuZXcgQXJyYXkoc2l6ZU51bWJlcik7XHJcbn1cclxuZm9yIChsZXQgbiA9IDA7IG4gPCBzaXplTnVtYmVyOyBuKyspIHtcclxuICAgIGZvciAobGV0IG0gPSAwOyBtIDwgc2l6ZU51bWJlcjsgbSsrKSB7XHJcbiAgICAgICAgcWl6aUNvbG9yRGF0YVtuXVttXSA9IDM7XHJcbiAgICB9XHJcbn1cclxubGV0IGN0eCA9IG15Q2FudmFzLmdldENvbnRleHQoJzJkJykgYXMgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG4vKipcclxuICog57uY5Yi25qOL55uYXHJcbiAqL1xyXG5mdW5jdGlvbiBxaXBhbigpOiB2b2lkIHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZU51bWJlcjsgaSsrKSB7XHJcbiAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIGN0eC5tb3ZlVG8oMCwgc2l6ZSAqIGkpO1xyXG4gICAgICAgIGN0eC5saW5lVG8oNTAwLCBzaXplICogaSk7XHJcbiAgICAgICAgY3R4Lm1vdmVUbyhzaXplICogaSwgMCk7XHJcbiAgICAgICAgY3R4LmxpbmVUbyhzaXplICogaSwgNTAwKTtcclxuICAgICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgfVxyXG59XHJcbnFpcGFuKCk7XHJcbi8qKlxyXG4gKue7mOWItuaji+WtkFxyXG4gKiBAcGFyYW0gcm93IHjovbTlnZDmoIdcclxuICogQHBhcmFtIGNvbCB56L205Z2Q5qCHXHJcbiAqIEBwYXJhbSBjb2xvciDmo4vlrZDpopzoibIgXHJcbiAqL1xyXG5mdW5jdGlvbiBxaXppKHJvdzogbnVtYmVyLCBjb2w6IG51bWJlciwgY29sb3I6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgY3R4LmFyYyhyb3csIGNvbCwgciwgMCwgMiAqIE1hdGguUEkpXHJcbiAgICBjdHguZmlsbFN0eWxlID0gY29sb3I7XHJcbiAgICBjdHguZmlsbCgpO1xyXG4gICAgY3R4LmNsb3NlUGF0aCgpO1xyXG59XHJcbi8qKlxyXG4gKiDkuIvmo4tcclxuICogQHBhcmFtIGUg5LqL5Lu2XHJcbiAqL1xyXG5teUNhbnZhcy5vbmNsaWNrID0gZnVuY3Rpb24gKGU6IE1vdXNlRXZlbnQpOiB2b2lkIHtcclxuICAgIGxldCB4OiBudW1iZXIgPSBlLmNsaWVudFggLSBteUNhbnZhcy5vZmZzZXRMZWZ0O1xyXG4gICAgbGV0IHk6IG51bWJlciA9IGUuY2xpZW50WSAtIG15Q2FudmFzLm9mZnNldFRvcDtcclxuICAgIGxldCBpOiBudW1iZXIgPSBNYXRoLnJvdW5kKHggLyBzaXplKTtcclxuICAgIGxldCBqOiBudW1iZXIgPSBNYXRoLnJvdW5kKHkgLyBzaXplKTtcclxuICAgIHdlaXppID0gW2ksIGpdO1xyXG4gICAgaWYgKHFpemlDb2xvckRhdGFbaV1bal0gPT0gMykge1xyXG4gICAgICAgIGlmIChxaXppQ29sb3IpIHtcclxuICAgICAgICAgICAgcWl6aShpICogc2l6ZSwgaiAqIHNpemUsICdyZWQnKTtcclxuICAgICAgICAgICAgcWl6aUNvbG9yID0gMDtcclxuICAgICAgICAgICAgcWl6aUNvbG9yRGF0YVtpXVtqXSA9IDE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcWl6aShpICogc2l6ZSwgaiAqIHNpemUsICdibGFjaycpO1xyXG4gICAgICAgICAgICBxaXppQ29sb3IgPSAxO1xyXG4gICAgICAgICAgICBxaXppQ29sb3JEYXRhW2ldW2pdID0gMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBqdWRnZShpLCBqKSAvL+WIpOaWrei+k+i1olxyXG4gICAgY2hlcWkgPSBmYWxzZTtcclxuICAgIGh1aXFpID0gdHJ1ZTtcclxufVxyXG4vKipcclxuICog5oKU5qOLXHJcbiAqL1xyXG5idG5odWkub25jbGljayA9IGZ1bmN0aW9uICgpOiB2b2lkIHtcclxuICAgIGlmIChodWlxaSA9PSB0cnVlKSB7XHJcbiAgICAgICAgY3R4LmNsZWFyUmVjdCh3ZWl6aVswXSAqIHNpemUgLSByLCB3ZWl6aVsxXSAqIHNpemUgLSByLCBzaXplLCBzaXplKTtcclxuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XHJcblxyXG4gICAgICAgIGN0eC5tb3ZlVG8oKHdlaXppWzBdIC0gMSkgKiBzaXplLCB3ZWl6aVsxXSAqIHNpemUpXHJcbiAgICAgICAgY3R4LmxpbmVUbygod2VpemlbMF0gKyAxKSAqIHNpemUsIHdlaXppWzFdICogc2l6ZSlcclxuXHJcbiAgICAgICAgY3R4Lm1vdmVUbyh3ZWl6aVswXSAqIHNpemUsICh3ZWl6aVsxXSAtIDEpICogc2l6ZSlcclxuICAgICAgICBjdHgubGluZVRvKHdlaXppWzBdICogc2l6ZSwgKHdlaXppWzFdICsgMSkgKiBzaXplKVxyXG5cclxuICAgICAgICBjdHguc3Ryb2tlKCk7XHJcbiAgICAgICAgY3R4LmNsb3NlUGF0aDtcclxuICAgICAgICBxaXppQ29sb3IgPSBxaXppQ29sb3IgPT0gMSA/IDAgOiAxO1xyXG4gICAgICAgIGNoZXFpID0gdHJ1ZTtcclxuICAgICAgICBxaXppQ29sb3JEYXRhW3dlaXppWzBdXVt3ZWl6aVsxXV0gPSAzO1xyXG4gICAgfVxyXG5cclxufVxyXG4vKipcclxuICog5pKk6ZSA5oKU5qOLXHJcbiAqL1xyXG5idG5jaGUub25jbGljayA9IGZ1bmN0aW9uICgpOiB2b2lkIHtcclxuICAgIGlmIChjaGVxaSA9PSB0cnVlKSB7XHJcbiAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIGN0eC5hcmMod2VpemlbMF0gKiBzaXplLCB3ZWl6aVsxXSAqIHNpemUsIHIsIDAsIDIgKiBNYXRoLlBJKVxyXG4gICAgICAgIGlmIChxaXppQ29sb3IgPT0gMSkge1xyXG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gJ3JlZCc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICdibGFjayc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN0eC5maWxsKCk7XHJcbiAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgICAgIHFpemlDb2xvckRhdGFbd2VpemlbMF1dW3dlaXppWzFdXSA9IHFpemlDb2xvcjtcclxuICAgICAgICBxaXppQ29sb3IgPSBxaXppQ29sb3IgPT0gMSA/IDAgOiAxXHJcbiAgICAgICAgY2hlcWkgPSBmYWxzZTtcclxuICAgIH1cclxufVxyXG5idG5jei5vbmNsaWNrID0gZnVuY3Rpb24gKCk6IHZvaWQge1xyXG4gICAgY3R4LmNsZWFyUmVjdCgwLCAwLCA1MDAsIDUwMCk7XHJcbiAgICBxaXBhbigpO1xyXG59XHJcbi8qKlxyXG4gKiDovpPotaLnmoTpgLvovpFcclxuICogQHBhcmFtIHJvdyB46L20IFxyXG4gKiBAcGFyYW0gY29sIHnovbQgXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24ganVkZ2Uocm93OiBudW1iZXIsIGNvbDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBjb25zdCBkaXJlY3Rpb25EYXRhOiBBcnJheTxhbnk+ID0gW1xyXG4gICAgICAgIFstMSwgMF0sIFsxLCAwXSwvL3jovbRcclxuICAgICAgICBbMCwgLTFdLCBbMCwgMV0sLy956L20XHJcbiAgICAgICAgWy0xLCAxXSwgWzEsIC0xXSwvL+W3puS4iuWIsOWPs+S4i1xyXG4gICAgICAgIFstMSwgLTFdLCBbMSwgMV0vL+W3puS4i+WIsOWPs+S4ilxyXG4gICAgXVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcclxuICAgICAgICBsZXQgY29sb3IgPSBxaXppQ29sb3JEYXRhW3Jvd11bY29sXTtcclxuICAgICAgICBsZXQgbmV4dFggPSAwLCBuZXh0WSA9IDAsIG9mZnNldFggPSAwLCBvZmZzZXRZID0gMDtcclxuICAgICAgICBsZXQgY291bnQgPSAxO1xyXG4gICAgICAgIGlmIChpICUgMiA9PSAwKSB7XHJcbiAgICAgICAgICAgIGNvdW50ID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgW29mZnNldFgsIG9mZnNldFldID0gZGlyZWN0aW9uRGF0YS5wb3AoKTtcclxuICAgICAgICBuZXh0WCA9IHJvdztcclxuICAgICAgICBuZXh0WSA9IGNvbDtcclxuICAgICAgICB3aGlsZSAobmV4dFggKyBvZmZzZXRYID49IDAgJiYgbmV4dFggKyBvZmZzZXRYIDwgMjEgJiZcclxuICAgICAgICAgICAgbmV4dFkgKyBvZmZzZXRZID49IDAgJiYgbmV4dFkgKyBvZmZzZXRZIDwgMjEgJiZcclxuICAgICAgICAgICAgcWl6aUNvbG9yRGF0YVtuZXh0WCArPSBvZmZzZXRYXVtuZXh0WSArPSBvZmZzZXRZXSA9PSBjb2xvcikge1xyXG4gICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY291bnQgPj0gNSkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGFsZXJ0KGDmga3llpwkeyfpu5HnuqInW2NvbG9yXX3oibLmo4vlrZDojrfog5whYCkpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iXX0=